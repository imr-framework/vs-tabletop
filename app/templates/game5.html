{% extends "base.html" %}
{% block content %}
    <div class="container-fluid vh-100">
    <div class="row h-100">
    <!-- Display panels on the left -->
        <div class="col-4 h-100" id="display-game5">
            <div class="row card bg-light">
                <div class="card-header">
                    Spin Animation
                </div>
                <div class="card-body">
                <div id='chart-spin' class='chart'></div>
                    </div>
          </div>
            <div class="row card">
                <div class="card-header">Signal</div>
                <div class="card-body">
                <div id='chart-signal' class='chart'></div>
                </div>
            </div>

        </div>
    <!-- Input fields -->
        <div class="col-8 h-100" id="fields-game5">

            <form action="/games/5" method="POST">
                {{ template_game_form.hidden_tag() }}
                <div class="row card">
                    <div class="card-header h3">Messages</div>
                    <div class="card-body">
                        <p id="message-game5">


                            <!-- Flash messages (TODO: replace with socket messages) -->
                        <!--    {% with messages = get_flashed_messages() %}
                                 {% if messages %}
                                    <div class='flashes text-danger'>
                                    {% for message in messages %}
                                      <p>{{ message }}</p>
                                    {% endfor %}
                                    </div>
                                 {% endif %}
                            {% endwith %} -->



                        </p>
                    </div>
                </div>
                <div class="row h-25 card">
                         <h3 class="card-header">Main field (Gauss)</h3>
                         <div class="card-body">
                         <div class="row">
                             <div class="col-4">
                                {{ template_game_form.b0_onoff_field(class="btn-check",id="b0_on",autocomplete="off",
                                                                     checked=session['game5']['b0_on']) }}
                                <label class="btn btn-outline-success" for="b0_on">
                                <svg xmlns="http://www.w3.org/2000/svg" width="42" height="42" fill="currentColor" class="bi bi-magnet-fill" viewBox="0 0 16 16">
                                  <path d="M15 12h-4v3h4v-3ZM5 12H1v3h4v-3ZM0 8a8 8 0 1 1 16 0v8h-6V8a2 2 0 1 0-4 0v8H0V8Z"/>
                                </svg>
                                </label>
                             </div>
                             <div class="col-8">
                                 <div class="row">
                                 {{ template_game_form.b0_field(class="form-range",id='b0',step=10, value=1e4*session['game5']['b0']) }}
                                 </div>
                                  <div class="ticks text-primary">
                                      {% for b in [0,20,40,60,80,100] %}
                                       <span class="tick">{{ b }}</span>
                                      {% endfor %}
                                  </div>
                             </div>
                         </div>
                         </div>
                    </div>
                <br>
                <div class="row h-25 card">
                    <h3 class="card-header">RF pulse</h3>
                    <div class="card-body">
                    <div class="row">
                        <div class="col-4">{{ template_game_form.flip_angle_field.label }}</div>
                        <div class="col-8">
                            <div class="row">
                            {{ template_game_form.flip_angle_field(class="form-range",id='flip_angle',step=5,value=session['game5']['flip_angle']) }}
                            </div>
                            <div class="ticks text-primary">
                            {% for angle in [0,45,90,135,180,225,270,315,360] %}
                            <span class="tick">{{ angle }}</span>
                            {% endfor %}
                            </div>
                        </div>

                    </div>
                    <div class="row">
                        <div class="col-4">{{ template_game_form.rf_phase_field.label }}</div>
                        <div class="col-8">
                            <div class="row">
                            {{ template_game_form.rf_phase_field(class="form-range",id='rf_phase',step=5,value=session['game5']['rf_phase']) }}
                            </div>
                            <div class="ticks text-primary">
                                {% for angle in [0,45,90,135,180,225,270,315,360] %}
                                <span class="tick">{{ angle }}</span>
                                {% endfor %}
                            </div>
                        </div>
                    </div>
                    </div>
                </div>
                <br>
                <div class="row h-25 card">
                    <h3 class="card-header">Receive coil</h3>
                    <div class="card-body row">
                    <div class="col-4">
                        <!-- input type="checkbox" class="btn-check" name="options-outlined" id="rx-button" autocomplete="off" -->
                        {{ template_game_form.rx_onoff_field(class="btn-check",id="rx-button",autocomplete="off",
                                                             checked=session['game5']['coil_on']) }}
                        <label class="btn btn-outline-info" for="rx-button">
                            <svg xmlns="http://www.w3.org/2000/svg" width="42" height="42" fill="currentColor" class="bi bi-bullseye" viewBox="0 0 16 16">
                               <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/>
                                <path d="M8 13A5 5 0 1 1 8 3a5 5 0 0 1 0 10zm0 1A6 6 0 1 0 8 2a6 6 0 0 0 0 12z"/>
                                <path d="M8 11a3 3 0 1 1 0-6 3 3 0 0 1 0 6zm0 1a4 4 0 1 0 0-8 4 4 0 0 0 0 8z"/>
                                <path d="M9.5 8a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0z"/>
                            </svg>
                         </label>
                    </div>
                        <div class="col-4">
                            {{ template_game_form.rot_frame_onoff_field(class="btn-check",id="rot-frame-button",autocomplete="off",
                                                                        checked=session['game5']['rot_frame_on']) }}
                            <label class="btn btn-outline-info" for="rot-frame-button">Rotating frame </label>
                        </div>

                        <div class="btn-group col-4">
                            {% for subfield in template_game_form.rx_dir_field %}
                                {% if subfield.id == "rx_dir_field-0" %}
                                    {{ subfield(class="btn-check ", autocomplete="off",checked=session['game5']['coil_dir']=='x') }}
                                {% else %}
                                    {{ subfield(class="btn-check ", autocomplete="off", checked=session['game5']['coil_dir']=='y') }}
                                {% endif %}
                                {{ subfield.label(class="btn btn-outline-primary d-flex align-items-center justify-content-center") }}

                            {% endfor %}
                        </div>



                        </div>

                    </div>

                <br>
                <div class="row h-25">
                    <div class="col-6 card bg-light">
                        <h3 class="card-header">Set initial magnetization</h3>
                        <div class="card-body">
                            <!-- Add in options to set initial magnetization value. -->
                            <div class="row">
                        <div class="col-8 btn-group">
                            <input type="radio" class="btn-check" name="mag-options" id="mag-x" autocomplete="off">
                            <label class="btn btn-outline-primary" for="mag-x">x</label>

                            <input type="radio" class="btn-check" name="mag-options" id="mag-y" autocomplete="off">
                            <label class="btn btn-outline-primary" for="mag-y">y</label>

                            <input type="radio" class="btn-check" name="mag-options" id="mag-z" autocomplete="off" checked>
                            <label class="btn btn-outline-primary" for="mag-z">z</label>

                            <input type="radio" class="btn-check" name="mag-options" id="mag-0" autocomplete="off">
                            <label class="btn btn-outline-primary" for="mag-0">0</label>
                        </div>
                            <div class="col-4">
                                <div class="btn btn-primary d-flex align-items-center justify-content-center" id="set-mag">SET</div>
                            </div>
                        </div>

                            <div class="row">
                            <div class="col">
                                {{ template_game_form.m_theta_field.label }}
                                {{ template_game_form.m_theta_field(class="form-control",id='m_theta',value=session['game5']['m_theta']) }}
                            </div>
                            <div class="col">
                                {{ template_game_form.m_phi_field.label }}
                                {{ template_game_form.m_phi_field(class="form-control",id='m_phi',value=session['game5']['m_phi']) }}
                            </div>
                            <div class="col">
                                {{ template_game_form.m_size_field.label }}
                                {{ template_game_form.m_size_field(class="form-control",id='m_size',value=session['game5']['m_size']) }}
                            </div>
                            </div>

                        </div>

                    </div>
                    <div class="col-6 card bg-light" id="game5-button-region">
                        <h3 class="card-header">Controls</h3>
                        <div class="row card-body">
                            <!--{{template_game_form.submit_field(class_="btn btn-success btn-lg col")}}-->
                            <div class="btn btn-info btn-lg col d-flex align-items-center justify-content-center" id="start">START</div>
                            <div class="btn btn-danger btn-lg col d-flex align-items-center justify-content-center" id="stop">STOP</div>
                            <div class="btn btn-success btn-lg col d-flex align-items-center justify-content-center" id="tip">TIP!</div>
                            <div class="btn btn-light btn-outline-primary btn-lg col d-flex align-items-center justify-content-center" id="reset">RESET</div>

                        </div>
                        <!-- Saving current parameters, loading previous ones -->

                        </div>
                    </div>

            </form>
        </div>
    </div>
    </div>

     <!-- Javascript for Plotly integration (required)-->

    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>







{% endblock %}

{% block additional_imports %}
    <script src="../static/game5.js"></script>
    <script type="text/javascript">
    graphData = {{ graphJSON_spin | safe }};
    graphData2 = {{ graphJSON_signal | safe }}
    play_animation_spin(graphData,false);
    play_animation_signal(graphData2,false);
    </script>

{% endblock %}